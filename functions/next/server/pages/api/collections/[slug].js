"use strict";(()=>{var e={};e.id=518,e.ids=[518],e.modules={260:(e,t,n)=>{n.d(t,{Sm:()=>s,Z2:()=>r,fb:()=>o,nM:()=>i});let a={};function r(e,t=6e5){let n=a[e],o=Date.now();return n&&o-n.timestamp<t?n.data:null}function o(e,t){a[e]={data:t,timestamp:Date.now()}}async function i(e,t){let n=r(e,1/0);if(n)return n;let a=await t();return o(e,a),a}function s(e){e?delete a[e]:Object.keys(a).forEach(e=>delete a[e])}},806:(e,t,n)=>{n.a(e,async(e,a)=>{try{n.r(t),n.d(t,{config:()=>c,default:()=>u,routeModule:()=>d});var r=n(3480),o=n(8667),i=n(6435),s=n(9755),l=e([s]);s=(l.then?(await l)():l)[0];let u=(0,i.M)(s,"default"),c=(0,i.M)(s,"config"),d=new r.PagesAPIRouteModule({definition:{kind:o.A.PAGES_API,page:"/api/collections/[slug]",pathname:"/api/collections/[slug]",bundlePath:"",filename:""},userland:s});a()}catch(e){a(e)}})},1402:e=>{e.exports=import("@prisma/extension-accelerate")},2978:(e,t,n)=>{n.a(e,async(e,a)=>{try{n.d(t,{A:()=>s});var r=n(6330),o=n(1402),i=e([o]);o=(i.then?(await i)():i)[0];let s=new r.PrismaClient().$extends((0,o.withAccelerate)());a()}catch(e){a(e)}})},3480:(e,t,n)=>{e.exports=n(5600)},5600:e=>{e.exports=require("next/dist/compiled/next-server/pages-api.runtime.prod.js")},6330:e=>{e.exports=require("@prisma/client")},6435:(e,t)=>{Object.defineProperty(t,"M",{enumerable:!0,get:function(){return function e(t,n){return n in t?t[n]:"then"in t&&"function"==typeof t.then?t.then(t=>e(t,n)):"function"==typeof t&&"default"===n?t:void 0}}})},8667:(e,t)=>{Object.defineProperty(t,"A",{enumerable:!0,get:function(){return n}});var n=function(e){return e.PAGES="PAGES",e.PAGES_API="PAGES_API",e.APP_PAGE="APP_PAGE",e.APP_ROUTE="APP_ROUTE",e.IMAGE="IMAGE",e}({})},9755:(e,t,n)=>{n.a(e,async(e,a)=>{try{n.r(t),n.d(t,{default:()=>s});var r=n(2978),o=n(260),i=e([r]);r=(i.then?(await i)():i)[0];let l=e=>new Date(e).toISOString().split("T")[0],u={"island-tour":{name:"Island Tour",dates:["1998-04-02","1998-04-03","1998-04-04","1998-04-05"]},halloween:{name:"Halloween Shows",match:e=>{let[t,n,a]=e.split("-").map(Number);return 10===n&&31===a}},nye:{name:"New Yearâ€™s Runs",match:e=>{let[t,n,a]=e.split("-").map(Number);return 12===n&&[31].includes(a)}}};async function s(e,t){let{slug:n}=e.query,a=u[n];if(!a)return t.status(404).json({error:"Collection not found"});let i=await (0,o.nM)("all-shows",async()=>(console.log("\uD83D\uDFE1 Cache miss: fetching all shows from DB"),await r.A.show.findMany({orderBy:{showDate:"asc"}})));console.log("\uD83D\uDFE2 Cache hit: using all-shows from memory");let s=[];a.dates?s=i.filter(e=>a.dates.includes(l(e.showDate))):a.match&&(s=i.filter(e=>a.match(l(e.showDate),e)));let c=s.map(e=>({...e,showDate:l(e.showDate)}));return t.status(200).json(c)}a()}catch(e){a(e)}})}};var t=require("../../../webpack-api-runtime.js");t.C(e);var n=t(t.s=806);module.exports=n})();