"use strict";(()=>{var e={};e.id=855,e.ids=[855],e.modules={260:(e,t,r)=>{r.d(t,{Sm:()=>i,Z2:()=>a,fb:()=>o,nM:()=>s});let n={};function a(e,t=6e5){let r=n[e],o=Date.now();return r&&o-r.timestamp<t?r.data:null}function o(e,t){n[e]={data:t,timestamp:Date.now()}}async function s(e,t){let r=a(e,1/0);if(r)return r;let n=await t();return o(e,n),n}function i(e){e?delete n[e]:Object.keys(n).forEach(e=>delete n[e])}},1402:e=>{e.exports=import("@prisma/extension-accelerate")},2142:(e,t,r)=>{r.a(e,async(e,n)=>{try{r.r(t),r.d(t,{config:()=>l,default:()=>u,routeModule:()=>f});var a=r(3480),o=r(8667),s=r(6435),i=r(6512),c=e([i]);i=(c.then?(await c)():c)[0];let u=(0,s.M)(i,"default"),l=(0,s.M)(i,"config"),f=new a.PagesAPIRouteModule({definition:{kind:o.A.PAGES_API,page:"/api/shows",pathname:"/api/shows",bundlePath:"",filename:""},userland:i});n()}catch(e){n(e)}})},2978:(e,t,r)=>{r.a(e,async(e,n)=>{try{r.d(t,{A:()=>i});var a=r(6330),o=r(1402),s=e([o]);o=(s.then?(await s)():s)[0];let i=new a.PrismaClient().$extends((0,o.withAccelerate)());n()}catch(e){n(e)}})},3480:(e,t,r)=>{e.exports=r(5600)},5600:e=>{e.exports=require("next/dist/compiled/next-server/pages-api.runtime.prod.js")},6330:e=>{e.exports=require("@prisma/client")},6435:(e,t)=>{Object.defineProperty(t,"M",{enumerable:!0,get:function(){return function e(t,r){return r in t?t[r]:"then"in t&&"function"==typeof t.then?t.then(t=>e(t,r)):"function"==typeof t&&"default"===r?t:void 0}}})},6512:(e,t,r)=>{r.a(e,async(e,n)=>{try{r.r(t),r.d(t,{default:()=>i});var a=r(2978),o=r(260),s=e([a]);async function i(e,t){let{year:r}=e.query;if(!r)return t.status(400).json({error:"Missing year parameter"});let n=`shows-${r}`;try{let e=await (0,o.nM)(n,async()=>{console.log(`ðŸŸ¡ Cache miss: fetching shows for ${r} from DB`);let e=new Date(`${r}-01-01`),t=new Date(`${parseInt(r)+1}-01-01`);return await a.A.show.findMany({where:{showDate:{gte:e,lt:t}},orderBy:{showDate:"asc"}})});return console.log(`ðŸŸ¢ Cache hit: using shows-${r} from memory`),t.setHeader("Cache-Control","s-maxage=600, stale-while-revalidate"),t.status(200).json(e)}catch(e){console.error(`âŒ Error fetching shows for year ${r}:`,e),t.status(500).json({error:"Internal server error"})}}a=(s.then?(await s)():s)[0],n()}catch(e){n(e)}})},8667:(e,t)=>{Object.defineProperty(t,"A",{enumerable:!0,get:function(){return r}});var r=function(e){return e.PAGES="PAGES",e.PAGES_API="PAGES_API",e.APP_PAGE="APP_PAGE",e.APP_ROUTE="APP_ROUTE",e.IMAGE="IMAGE",e}({})}};var t=require("../../webpack-api-runtime.js");t.C(e);var r=t(t.s=2142);module.exports=r})();